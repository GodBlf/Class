# boot

```go
package db

import (
	"gorm.io/gorm"
	"sync"
)

var (
	Db   *gorm.DB
	once sync.Once
)

func NewDB() *gorm.DB {
	once.Do(func() {
		Db = &gorm.DB{}
	})
	return Db
}
package dao

import (
	"gorm.io/gorm"
	"sync"
)

type DaoInterface interface {
	Dat()
}

var (
	Dao  *DaoImpl
	once sync.Once
)

type DaoImpl struct {
	number int
	db     *gorm.DB
}

func (d *DaoImpl) Dat() {
	return
}

func NewDaoImpl(d *gorm.DB) *DaoImpl {
	once.Do(func() {
		Dao = &DaoImpl{
			number: 1,
			db:     d,
		}
	})
	return Dao
}
package service

import (
	"sync"
	"wire_test/dao"
)

type ServiceInterface interface {
	Ser()
}

var (
	Service *ServiceImpl
	once    sync.Once
)

type ServiceImpl struct {
	Number int
	Dao    dao.DaoInterface
}

func (s *ServiceImpl) Ser() {
	return
}

func NewServiceImpl(d dao.DaoInterface) *ServiceImpl {
	once.Do(func() {
		Service = &ServiceImpl{
			Number: 1,
			Dao:    d,
		}
	})
	return Service
}
// Code generated by Wire. DO NOT EDIT.

//go:generate go run -mod=mod github.com/google/wire/cmd/wire
//go:build !wireinject
// +build !wireinject

package main

import (
	"wire_test/dao"
	"wire_test/db"
	"wire_test/service"
)

// Injectors from wire.go:

func InitializeService() *service.ServiceImpl {
	gormDB := db.NewDB()
	daoImpl := dao.NewDaoImpl(gormDB)
	serviceImpl := service.NewServiceImpl(daoImpl)
	return serviceImpl
}
// Code generated by Wire. DO NOT EDIT.

//go:generate go run -mod=mod github.com/google/wire/cmd/wire
//go:build !wireinject
// +build !wireinject

package main

import (
	"wire_test/dao"
	"wire_test/db"
	"wire_test/service"
)

// Injectors from wire.go:

func InitializeService() *service.ServiceImpl {
	gormDB := db.NewDB()
	daoImpl := dao.NewDaoImpl(gormDB)
	serviceImpl := service.NewServiceImpl(daoImpl)
	return serviceImpl
}

```
- 注意事项接口不能取地址* 
- 接口记得bind实现变量
- 传递变量注入即可剩下的接口选择哪个实现类等交给wire框架

# lazy global
- 懒全局变量实现依赖注入
为了保证仅初始化一次
用var sync.Once 保证仅初始化一次
