error传递到通道里


中间件-装饰器-函数闭包 :将对象包装（wrap）在另一个对象中，这个包装对象在调用原有方法前后添加新的行为，从而增强功能。
等待组,并发控制外移
wg.add一定要加到主线程不要加到子线程里边艹!!!
main{
wg := &sync.WaitGroup{}
	wg.Add(1)
	go func() {
		defer wg.Done()
		chatsession.ChatStream(ctx, "讲解算法中的二分答案法")
	}()
	wg.Add(1)
	go func() {
		defer wg.Done()
		chatsession.ChatStreamOut()
	}()
	wg.Wait()

}

websocket llm流式输出 grpc等的stream流
都可以视作一个chan stream.Recv()就是  <-chan 管道发出数据然后阻塞线程
for true{
    stream.Recv()
    if eof break
}
就是
for i := range chan